<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Sidus/EAVModelBundle</title>

        <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Merriweather:400,900,700,300|Open+Sans:400,800,700|Titillium+Web:600,400' type='text/css'>
        <link rel="stylesheet" href="https://vincentchalnot.github.io/SidusEAVModelBundle/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://vincentchalnot.github.io/SidusEAVModelBundle/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://vincentchalnot.github.io/SidusEAVModelBundle/css/github.css">
        <link rel="stylesheet" href="https://vincentchalnot.github.io/SidusEAVModelBundle/css/main.css">
    </head>
    <body>

        <header class="site-header">
            <div class="site-branding">
                <h1 class="site-name">
                    <a href="https://vincentchalnot.github.io/SidusEAVModelBundle" >Sidus/EAVModelBundle</a>&nbsp;&nbsp;<i class="fa fa-database"></i>
                </h1>
                <h2 class="site-description">Blazing fast data modeling with Symfony</h2>
            </div>

            <div class="button-line">
                <a href="https://github.com/VincentChalnot/SidusEAVModelBundle" target="_blank" class="btn btn-default">View on GitHub</a>
                <a href="https://github.com/VincentChalnot/SidusEAVModelBundle/zipball/master" class="btn btn-default hidden-xs">Download .zip</a>
                <a href="https://github.com/VincentChalnot/SidusEAVModelBundle/tarball/master" class="btn btn-default hidden-xs">Download .tar.gz</a>
            </div>

                            <a href="https://github.com/VincentChalnot/SidusEAVModelBundle">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
            <div class="text-left visible-xs-block" style="margin-left: 15px;">
                <a href="#sidebar" data-toggle="collapse"><i class="fa fa-3x fa-bars" aria-hidden="true"></i></a>
            </div>
        </header>

        <main class="container-fluid">
            <div class="row">

                                    <nav id="sidebar" class="col-sm-3 col-lg-2 collapse in" role="navigation">
                                                    <p class="text-muted">
                                Main documentation
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/01-install.html">
                                            01 - Installation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/02-model.html">
                                            02 - Model configuration
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/03-multiple.html">
                                            03 - Multiple attributes & collections
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/04-entities.html">
                                            04 - Handling Entities
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/05.1-form.html">
                                            05 - Forms
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/06-validate.html">
                                            06 - Validation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/07.1-query.html">
                                            07 - Query
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/08-translate.html">
                                            08 - Translating the model
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/09-context.html">
                                            19 - EAV Contextualisation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/10-serialize.html">
                                            10 - Serialization
                                        </a>
                                    </li>
                                                                    <li class="active">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/11-extend.html">
                                            11 - Extending & customizing the model
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/12-custom_classes.html">
                                            12 - Custom classes
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Other documentation entries
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/100-ide_autocomplete.html">
                                            IDE Autocomplete
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/200-questions.html">
                                            Questions & Answers
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://vincentchalnot.github.io/SidusEAVModelBundle/Documentation/300-performances.html">
                                            Performances
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-9 col-lg-10 content">
                    <h2 id="extending-the-model">Extending the model</h2>
<p>The existing model allows you to store all the basic kinds of scalar (text, number, dates) and relations to other
families.
However, you might need to store different kind of values in your model.</p>
<h3 id="custom-attribute-types">Custom attribute types</h3>
<p>Attribute types are the link between the user interface and your model, there are many scenarios where you will need
to override existing attribute types or create new ones.
If you take a look at the base Value class, you will notice that it contains a lot of properties suffixed by &quot;Value&quot;,
these properties are used to store all the different kind of PHP values and correspond to existing Doctrine types:</p>
<p>The scalar types:</p>
<ul>
<li>string (type=&quot;string&quot;, length=255)</li>
<li>text (type=&quot;text&quot;)</li>
<li>bool (type=&quot;boolean&quot;)</li>
<li>integer (type=&quot;integer&quot;)</li>
<li>decimal (type=&quot;float&quot;)</li>
<li>date (type=&quot;date&quot;)</li>
<li>datetime (type=&quot;datetime&quot;)</li>
</ul>
<p>There is also a &quot;dataValue&quot; which correspond to a Doctrine's association to an other entity (the actual entity is stored
in the &quot;data&quot;)</p>
<p>These properties are storage properties and can be reused for multiple attribute types and attributes.</p>
<h4 id="adding-new-attribute-types-using-existing-storage-properties">Adding new attribute types using existing storage properties</h4>
<p>To create a new attribute type base on one of the properties described earlier, just create a new service.
The first parameter is the attribute type code, the second one is the name of the property used to store the value in
the Value class and the third parameter is the form type.</p>
<pre><code class="language-yaml">services:
    my_namespace.attribute_type.my_attribute:
        class: '%sidus_eav_model.attribute_type.default.class%'
        arguments: [&lt;my_attribute_code&gt;, &lt;storage_property&gt;, &lt;my_namespace_form_type&gt;]
        tags:
            - { name: sidus.attribute_type }</code></pre>
<p>Don't forget to tag your service properly.</p>
<h4 id="overriding-existing-attribute-types">Overriding existing attribute types</h4>
<p>If you need to override an existing attribute type, you can use the following method.
Attribute types are standard tagged symfony services, you should'nt need to override the default class and you will see
that all existing attribute types are based on the same class.
For example if you need to override the form_type of the &quot;html&quot; type:</p>
<pre><code class="language-yaml">services:
    sidus_eav_model.attribute_type.html:
        class: '%sidus_eav_model.attribute_type.default.class%'
        arguments: [html, textValue, &lt;mynamespace_form_type&gt;]
        tags:
            - { name: sidus.attribute_type }</code></pre>
<p>You have to re-declare the whole attribute's type services and you can override more parameters if need be.</p>
<h4 id="custom-relations">Custom relations</h4>
<p>This chapter covers how to add a new relation to an other Doctrine entity in the EAV model.</p>
<p>First, add the relation in your Value class:</p>
<pre><code class="language-php">&lt;?php

namespace MyNamespace\EAVModelBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Sidus\EAVModelBundle\Entity\AbstractValue;
use MyNamespace\CustomBundle\Entity\Document;

/**
 * @ORM\Table(name="mynamespace_value")
 * @ORM\Entity(repositoryClass="Sidus\EAVModelBundle\Entity\ValueRepository")
 */
class Value extends AbstractValue
{
    /**
     * @var Document
     * @ORM\ManyToOne(targetEntity="MyNamespace\CustomBundle\Entity\Document", cascade={"persist"})
     * @ORM\JoinColumn(name="document_value_id", referencedColumnName="id", onDelete="cascade", nullable=true)
     */
    protected $documentValue;

    /**
     * @return Document
     */
    public function getDocumentValue()
    {
        return $this-&gt;documentValue;
    }

    /**
     * @param Document $documentValue
     */
    public function setDocumentValue(Document $documentValue = null)
    {
        $this-&gt;documentValue = $documentValue;
    }
}</code></pre>
<p>Then declare at least an attribute type using a custom form type:</p>
<pre><code class="language-yaml">services:
    my_namespace.attribute_type.document:
        class: '%sidus_eav_model.attribute_type.relation.class%'
        arguments: [document, documentValue, &lt;my_namespace_form_type&gt;]
        tags:
            - { name: sidus.attribute_type }</code></pre>
<p>You can start using your new attribute type right away in your model configuration.</p>
<h4 id="extra-customizations">Extra customizations</h4>
<p>Regarding the existing AttributeType class, there are a few more things you can do:</p>
<p>The fourth parameter of the attribute's types services can be used to set default form options for the form types.</p>
<p>Additionally, there is a few other options you might want to set using the &quot;calls&quot; options in the service definition</p>
<ul>
<li>setEmbedded: If the edition of your value's data is embedded, set this value to true, this will also cascade the
validation of the related value in the current form.</li>
<li>setRelation: By default it will be set to true if the storage property is not listed in the default storage properties
(excepted &quot;dataValue&quot;). You should not have to concern yourself with this but you can use it.</li>
</ul>
                </section>

            </div>
        </main>

        <footer class="site-footer">
            <div class="top-bar-line"></div>
            <div class="bottom-panel">
                <div class="text-center">
            <span>
                                    
                                                </span>
                </div><!-- text-center -->
            </div><!-- bottom-panel -->
        </footer>


        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script src="https://vincentchalnot.github.io/SidusEAVModelBundle/js/highlight.pack.js"></script>

        <script>
            hljs.initHighlighting();

            function checkWidth($highlight) {
                if ($(window).width() < 768) {
                    $highlight.addClass('collapse');
                } else {
                    $highlight.removeClass('collapse');
                }
            }

            $(document).ready(function () {
                var $highlights = $('.hljs');
                $highlights.each(function (index) {
                    var $this = $(this).parent();
                    var elementId = 'hljs' + index;
                    $this.attr('id', elementId);
                    $this.before('<a class="visible-xs-inline visible-sm-inline" href="#' + elementId + '" data-toggle="collapse"><i class="fa fa-expand"></i>&nbsp;Toggle source code ...</a>');

                    checkWidth($this);
                    $(window).resize(function () {
                        checkWidth($this);
                    });
                });
            });

            
        </script>

    </body>
</html>
